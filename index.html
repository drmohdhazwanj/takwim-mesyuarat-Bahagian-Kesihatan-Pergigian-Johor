<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>Takwim Mesyuarat 2026 | BKPJ JKN Johor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #f4f6f8;
}

/* HEADER */
.site-header {
  background: #0f2a44;
  color: white;
  padding: 20px;
  display: flex;
  align-items: center;
  position: relative;
}

.site-header .logo {
  height: 48px;
}

.header-text {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
}

.header-text h1 {
  margin: 0;
  font-size: 26px;
}

.header-text p {
  margin: 4px 0 0;
  font-size: 14px;
}

/* BAR ARAHAN */
.bar-arahan {
  background: #f1f5f9;
  color: #0f2a44;
  padding: 10px 16px;
  border-bottom: 2px solid #0f2a44;
  font-size: 14px;
  text-align: center;
}

/* PENGUMUMAN */
.pengumuman {
  max-width: 1000px;
  margin: 12px auto;
  padding: 14px 16px;
  background: #fff8e1;
  border-left: 6px solid #f4b400;
  font-size: 14px;
}

.pengumuman strong {
  display: block;
  font-size: 15px;
  margin-bottom: 4px;
}

/* TARIKH KEMASKINI */
.tarikh-kemaskini {
  max-width: 1000px;
  margin: 8px auto 0;
  padding: 0 16px;
  font-size: 13px;
  color: #555;
  text-align: right;
}

/* CONTAINER */
.container {
  max-width: 1000px;
  margin: 20px auto;
  padding: 0 16px;
}

/* FILTER */
.filters {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 10px;
}

.filters input,
.filters select,
.filters button {
  padding: 8px;
  font-size: 14px;
}

.filters button {
  background: #1f4d7a;
  color: white;
  border: none;
  cursor: pointer;
}

.filters button:hover {
  background: #163a5a;
}

/* MONTH */
.month {
  background: white;
  margin-bottom: 16px;
  border-radius: 8px;
  overflow: hidden;
}

.month-header {
  background: #1f4d7a;
  color: white;
  padding: 10px 14px;
  font-weight: bold;
}

.meeting {
  padding: 12px 14px;
  border-top: 1px solid #eee;
}

.meeting-title {
  font-weight: bold;
}

.meeting-meta {
  font-size: 13px;
  color: #555;
}

/* MOBILE */
@media (max-width: 600px) {
  .site-header {
    justify-content: center;
    padding-top: 70px;
  }

  .site-header .logo {
    position: absolute;
    top: 15px;
    left: 50%;
    transform: translateX(-50%);
  }

  .header-text {
    position: static;
    transform: none;
  }

  .tarikh-kemaskini {
    text-align: center;
  }
}

/* PRINT MODE */
@media print {
  body {
    background: white;
  }

  .filters,
  .bar-arahan,
  .pengumuman,
  button {
    display: none;
  }

  .site-header {
    background: white;
    color: black;
    border-bottom: 2px solid #000;
  }

  .site-header .logo {
    height: 40px;
  }

  .month {
    page-break-inside: avoid;
    border: 1px solid #000;
  }

  .month-header {
    background: #ddd;
    color: black;
  }

  .meeting {
    border-top: 1px solid #999;
  }

  a {
    color: black;
    text-decoration: none;
  }
}
</style>
</head>

<body>

<header class="site-header">
  <img src="logo-kerajaan.png" alt="Logo Kerajaan Malaysia" class="logo">
  <div class="header-text">
    <h1>TAKWIM MESYUARAT 2026</h1>
    <p>Bahagian Kesihatan Pergigian<br>Jabatan Kesihatan Negeri Johor</p>
  </div>
</header>

<div class="bar-arahan">
Sekiranya terdapat perubahan tarikh, mohon maklumkan kepada
<strong>Dr. Mohamad Hazwan bin Jamaludin</strong>
di talian <strong>010-6628023</strong> atau emel
<a href="mailto:drmohdhazwan.j@moh.gov.my">drmohdhazwan.j@moh.gov.my</a>
</div>

<div class="pengumuman" id="mesyuaratSeterusnya"></div>
<div class="tarikh-kemaskini" id="tarikhKemaskini"></div>

<div class="container">

<div class="filters">
  <input type="text" placeholder="Cari mesyuarat‚Ä¶" oninput="applyFilters()">
  <select id="bulan" onchange="applyFilters()">
    <option>Semua Bulan</option>
  </select>
  <select id="urusetia" onchange="applyFilters()">
    <option>Semua Urusetia</option>
  </select>
  <button onclick="window.print()">Cetak Takwim</button>
</div>

<div id="takwim"></div>

</div>

<script>
let DATA = {};

fetch('takwim-2026.json')
.then(r => r.json())
.then(data => {
  DATA = data;

  if (data._meta && data._meta.tarikh_kemaskini) {
    document.getElementById('tarikhKemaskini').innerText =
      'Tarikh kemaskini terakhir: ' + data._meta.tarikh_kemaskini;
  }

  paparMesyuaratSeterusnya(DATA);
  initFilters();
  render(DATA);
});

function paparMesyuaratSeterusnya(data) {
  const hariIni = new Date();
  let senarai = [];

  Object.keys(data).filter(k => k !== '_meta').forEach(bulan => {
    data[bulan].forEach(m => {
      const tarikh = ekstrakTarikh(m.date);
      if (tarikh && tarikh >= hariIni) {
        senarai.push({ ...m, tarikhObj: tarikh });
      }
    });
  });

  if (senarai.length === 0) return;

  senarai.sort((a, b) => a.tarikhObj - b.tarikhObj);
  const next = senarai[0];

  document.getElementById('mesyuaratSeterusnya').innerHTML = `
    <strong>üì¢ Mesyuarat Terdekat</strong>
    ${next.title}<br>
    üóìÔ∏è ${next.date}<br>
    üè¢ ${next.urusetia}
  `;
}

function ekstrakTarikh(teks) {
  const padanan = teks.match(/(\d{1,2}) (\w+) (\d{4})/);
  if (!padanan) return null;

  const bulanMap = {
    Januari: 0, Februari: 1, Mac: 2, April: 3, Mei: 4, Jun: 5,
    Julai: 6, Ogos: 7, September: 8, Oktober: 9, November: 10, Disember: 11
  };

  return new Date(
    parseInt(padanan[3]),
    bulanMap[padanan[2]],
    parseInt(padanan[1])
  );
}

function initFilters() {
  const bulan = document.getElementById('bulan');
  const urusetia = document.getElementById('urusetia');

  Object.keys(DATA).filter(k => k !== '_meta').forEach(b => {
    bulan.innerHTML += `<option>${b}</option>`;
    DATA[b].forEach(m => {
      if (![...urusetia.options].some(o => o.value === m.urusetia)) {
        urusetia.innerHTML += `<option>${m.urusetia}</option>`;
      }
    });
  });
}

function applyFilters() {
  const key = document.querySelector('input').value.toLowerCase();
  const bulan = document.getElementById('bulan').value;
  const uru = document.getElementById('urusetia').value;
  const out = {};

  Object.keys(DATA).filter(k => k !== '_meta').forEach(b => {
    if (bulan !== 'Semua Bulan' && b !== bulan) return;
    const list = DATA[b].filter(m =>
      (!key || m.title.toLowerCase().includes(key)) &&
      (uru === 'Semua Urusetia' || m.urusetia === uru)
    );
    if (list.length) out[b] = list;
  });

  render(out);
}

function render(data) {
  const el = document.getElementById('takwim');
  el.innerHTML = '';

  Object.keys(data).filter(k => k !== '_meta').forEach(b => {
    let html = `<div class="month">
      <div class="month-header">${b} 2026</div>`;

    data[b].forEach(m => {
      html += `
      <div class="meeting">
        <div class="meeting-title">${m.title}</div>
        <div class="meeting-meta">${m.date} ¬∑ ${m.urusetia}</div>
      </div>`;
    });

    html += '</div>';
    el.innerHTML += html;
  });
}
</script>

</body>
</html>
